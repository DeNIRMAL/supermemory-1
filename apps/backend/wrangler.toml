name = "supermemory-backend"
main = "src/index.tsx"
compatibility_date = "2024-10-11"
compatibility_flags = [ "nodejs_compat" ]

[assets]
directory = "./public/"
binding = "ASSETS"


[observability]
enabled = true

[placement]
mode = "smart"

[ai]
binding = "AI"

[[workflows]]
name = "content-workflow-supermemory"
binding = "CONTENT_WORKFLOW"
class_name = "ContentWorkflow"


[[r2_buckets]]
binding = "IMAGES_BUCKET"
bucket_name = "supermemory-images"
preview_bucket_name = "supermemory-images"

[[kv_namespaces]]
binding= "MD_CACHE"
id = "cac3a234a4374158b3b42a3ab4dd568d"
preview_id = "cac3a234a4374158b3b42a3ab4dd568d"

[[kv_namespaces]]
binding = "ENCRYPTED_TOKENS"
id = "62a7415a6e8f4ee2bdc0b308c3666838"
preview_id = "62a7415a6e8f4ee2bdc0b308c3666838"

[[hyperdrive]]
binding = "HYPERDRIVE"
id = "51da5594ec86434c8c2375c15935440c"
localConnectionString = "postgresql://postgres:%40Gmail12345@db.sdohppbkaordjydyhwqf.supabase.co:5432/postgres"

[[unsafe.bindings]]
name = "EMAIL_LIMITER"
type = "ratelimit"
namespace_id = "2114284"
simple = { limit = 1, period = 60 }

tail_consumers = [{service = "supermemory-backend-tail"}]

[[durable_objects.bindings]]
name = "RATE_LIMITER"
class_name = "DurableObjectRateLimiter"

[[migrations]]
tag = "v1"
new_classes = ["DurableObjectRateLimiter"]